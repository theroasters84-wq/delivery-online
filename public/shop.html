<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roasters Shop - Dashboard</title>
    <style>
        body { background: #1a1a1a; color: #fff; font-family: sans-serif; text-align: center; margin: 0; padding: 20px; }
        .container { max-width: 500px; margin: auto; background: #222; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        h1 { color: #ffc107; margin-bottom: 10px; }
        input { width: 90%; padding: 15px; margin: 10px 0; border-radius: 8px; border: 1px solid #444; background: #000; color: #fff; font-size: 1.1em; text-align: center; }
        .btn-send { background: #ffc107; color: #000; padding: 20px; border-radius: 12px; font-weight: 900; font-size: 1.3em; border: none; width: 100%; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .btn-send:active { transform: scale(0.98); background: #e0a800; }
        #status { margin-top: 25px; padding: 20px; border-radius: 10px; min-height: 50px; font-weight: bold; }
        .waiting { background: #333; color: #aaa; border: 1px dashed #555; }
        .confirmed { background: #28a745; color: white; border: none; animation: pop 0.3s ease-out; }
        @keyframes pop { 0% { transform: scale(0.8); } 100% { transform: scale(1); } }
        .log-out { color: #666; font-size: 0.8em; cursor: pointer; margin-top: 20px; display: block; }
    </style>
</head>
<body>

    <div class="container">
        <h1>ROASTERS SHOP</h1>
        
        <div id="setup-ui">
            <p>Î Î»Î·ÎºÏ„ÏÎ¿Î»ÏŒÎ³Î·ÏƒÎµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… Î¼Î±Î³Î±Î¶Î¹Î¿Ï Î³Î¹Î± Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹Ï‚:</p>
            <input type="text" id="shopName" placeholder="Ï€.Ï‡. roasters">
            <button class="btn-send" onclick="initShop()">Î•Î™Î£ÎŸÎ”ÎŸÎ£</button>
        </div>

        <div id="main-ui" style="display:none;">
            <p>ÎœÎ±Î³Î±Î¶Î¯: <b id="active-shop" style="color:#ffc107;"></b></p>
            <hr style="border: 0.5px solid #333;">
            <br>
            <button class="btn-send" onclick="sendOrder()">ğŸš€ Î£Î¤Î•Î™Î›Î• Î Î‘Î¡Î‘Î“Î“Î•Î›Î™Î‘</button>
            
            <div id="status" class="waiting">
                Î‘Î½Î±Î¼Î¿Î½Î® Î³Î¹Î± Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±...
            </div>

            <span class="log-out" onclick="logout()">Î‘Î»Î»Î±Î³Î® ÎœÎ±Î³Î±Î¶Î¹Î¿Ï</span>
        </div>
    </div>

    <audio id="confirmsound" src="https://actions.google.com/sounds/v1/communication/notification_high_intensity.ogg"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const confirmSound = document.getElementById('confirmsound');

        function initShop() {
            const name = document.getElementById('shopName').value.trim().toLowerCase();
            if(!name) return alert("Î’Î¬Î»Îµ ÏŒÎ½Î¿Î¼Î± Î¼Î±Î³Î±Î¶Î¹Î¿Ï!");
            localStorage.setItem('myShopName', name);
            location.reload();
        }

        function checkAuth() {
            const savedShop = localStorage.getItem('myShopName');
            if(savedShop) {
                document.getElementById('setup-ui').style.display = 'none';
                document.getElementById('main-ui').style.display = 'block';
                document.getElementById('active-shop').innerText = savedShop.toUpperCase();
                
                // Î£ÏÎ½Î´ÎµÏƒÎ· ÏƒÏ„Î¿ "Î´Ï‰Î¼Î¬Ï„Î¹Î¿" Ï„Î¿Ï… Î¼Î±Î³Î±Î¶Î¹Î¿Ï
                socket.emit('driver-login', { shop: savedShop, name: 'SHOP_MASTER' });
            }
        }

        function sendOrder() {
            const shop = localStorage.getItem('myShopName');
            const statusDiv = document.getElementById('status');
            
            // Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬ status
            statusDiv.className = 'waiting';
            statusDiv.innerHTML = "ğŸ“¡ Î— Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ!<br>Î ÎµÏÎ¹Î¼Î­Î½Î¿Ï…Î¼Îµ Ï„Î¿Î½ Î¿Î´Î·Î³ÏŒ...";

            // Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® ÏƒÎ®Î¼Î±Ï„Î¿Ï‚ ÏƒÏ„Î¿Î½ Server
            socket.emit('new-order', {
                shopName: shop,
                time: new Date().toLocaleTimeString()
            });
        }

        // Î›Î®ÏˆÎ· ÎµÏ€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ·Ï‚ Î±Ï€ÏŒ Ï„Î¿Î½ Î¿Î´Î·Î³ÏŒ
        socket.on('order-confirmed', (data) => {
            const statusDiv = document.getElementById('status');
            confirmSound.play().catch(()=>{});
            
            statusDiv.className = 'confirmed';
            statusDiv.innerHTML = `âœ… Î‘Î ÎŸÎ”ÎŸÎ§Î—!<br>ÎŸ Î¿Î´Î·Î³ÏŒÏ‚ <span style="font-size:1.2em;">${data.driverName}</span> Ï€Î®ÏÎµ Ï„Î·Î½ Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±.`;
            
            // ÎœÎµÏ„Î¬ Î±Ï€ÏŒ 10 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î± ÎµÏ€Î±Î½Î­ÏÏ‡ÎµÏ„Î±Î¹ ÏƒÏ„Î·Î½ Î±Î½Î±Î¼Î¿Î½Î®
            setTimeout(() => {
                if(statusDiv.className === 'confirmed') {
                    statusDiv.className = 'waiting';
                    statusDiv.innerHTML = "Î‘Î½Î±Î¼Î¿Î½Î® Î³Î¹Î± Î½Î­Î± Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î±...";
                }
            }, 10000);
        });

        function logout() {
            localStorage.clear();
            location.reload();
        }

        window.onload = checkAuth;
    </script>
</body>
</html>
