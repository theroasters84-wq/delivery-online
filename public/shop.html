<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop - The Roasters</title>
    <style>
        body { font-family: sans-serif; text-align: center; background: #f4f4f4; padding: 20px; }
        .card { max-width: 400px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .driver-row { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #eee; }
        .btn-call { background: #2ecc71; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        #status-bar { margin-top: 20px; font-weight: bold; font-size: 1.2em; color: #555; }
    </style>
</head>
<body>
    <div class="card">
        <h2 id="shop-title">Shop Panel</h2>
        <div id="driver-list">Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î´Î¹Î±Î½Î¿Î¼Î­Ï‰Î½...</div>
        <div id="status-bar">Î•Î¤ÎŸÎ™ÎœÎŸ</div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        let myShop = localStorage.getItem('activeShop') || prompt("ÎŒÎ½Î¿Î¼Î± ÎœÎ±Î³Î±Î¶Î¹Î¿Ï:");
        if(myShop) {
            myShop = myShop.toLowerCase().trim();
            localStorage.setItem('activeShop', myShop);
            document.getElementById('shop-title').innerText = myShop.toUpperCase();
            socket.emit('join-shop', myShop);
        }

        socket.on('update-drivers', (drivers) => {
            const list = document.getElementById('driver-list');
            list.innerHTML = "";
            Object.keys(drivers).forEach(id => {
                list.innerHTML += `
                    <div class="driver-row">
                        <span>ðŸ‘¤ ${drivers[id]}</span>
                        <button class="btn-call" onclick="callDriver('${id}')">ÎšÎ›Î—Î£Î—</button>
                    </div>`;
            });
        });

        function callDriver(id) {
            socket.emit('call-driver', { driverId: id, shop: myShop });
            document.getElementById('status-bar').innerText = "ÎšÎ»Î®ÏƒÎ· ÏƒÎµ ÎµÎ¾Î­Î»Î¹Î¾Î·...";
        }

        socket.on('driver-accepted', (data) => {
            document.getElementById('status-bar').innerText = "âœ… " + data.driverName + " Î•Î¡Î§Î•Î¤Î‘Î™!";
            setTimeout(() => { document.getElementById('status-bar').innerText = "Î•Î¤ÎŸÎ™ÎœÎŸ"; }, 5000);
        });
    </script>
</body>
</html>
