<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roasters Shop - Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·</title>
    <style>
        body { font-family: sans-serif; background: #f4f4f4; margin: 0; padding: 20px; text-align: center; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        h1 { color: #333; }
        .status-box { background: #eee; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
        .driver-list { list-style: none; padding: 0; text-align: left; }
        .driver-item { background: #e8f5e9; padding: 10px; margin: 5px 0; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid #4caf50; }
        .btn-order { background: #ffc107; color: black; border: none; padding: 20px; width: 100%; border-radius: 10px; font-size: 1.2em; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-order:active { transform: scale(0.98); background: #e0ac08; }
        #logs { margin-top: 20px; font-size: 0.9em; color: #666; height: 100px; overflow-y: auto; border-top: 1px solid #ddd; padding-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸª Roasters Shop</h1>
    
    <div class="status-box">
        <input type="text" id="shopName" placeholder="ÎŒÎ½Î¿Î¼Î± ÎšÎ±Ï„Î±ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ (Ï€.Ï‡. roasters1)" style="width: 80%; padding: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc;">
        <button onclick="connectShop()" style="padding: 10px 20px; background: #333; color: white; border: none; border-radius: 5px; cursor: pointer;">Î£ÏÎ½Î´ÎµÏƒÎ· ÎšÎ±Ï„Î±ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚</button>
    </div>

    <div class="status-box">
        <h3>ÎŸÎ´Î·Î³Î¿Î¯ Online:</h3>
        <ul id="driverList" class="driver-list">
            <li style="color: #888;">ÎšÎ±Î½Î­Î½Î±Ï‚ Î¿Î´Î·Î³ÏŒÏ‚ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Ï‚...</li>
        </ul>
    </div>

    <button class="btn-order" onclick="sendOrder()">ğŸ”” Î‘Î ÎŸÎ£Î¤ÎŸÎ›Î— Î Î‘Î¡Î‘Î“Î“Î•Î›Î™Î‘Î£</button>

    <div id="logs"></div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();
    const logs = document.getElementById('logs');
    const driverListUI = document.getElementById('driverList');

    function addLog(msg) {
        const div = document.createElement('div');
        div.innerText = `${new Date().toLocaleTimeString()}: ${msg}`;
        logs.prepend(div);
    }

    function connectShop() {
        const shop = document.getElementById('shopName').value.toLowerCase().trim();
        if(!shop) return alert("Î’Î¬Î»Îµ ÏŒÎ½Î¿Î¼Î± Î¼Î±Î³Î±Î¶Î¹Î¿Ï!");
        
        socket.emit('shop-login', { shop: shop });
        addLog(`Î£Ï…Î½Î´Î­Î¸Î·ÎºÎµÏ‚ ÏƒÏ„Î¿ ÎºÎ±Î½Î¬Î»Î¹: ${shop}`);
        document.getElementById('shopName').disabled = true;
    }

    // ÎŒÏ„Î±Î½ Î­Î½Î±Ï‚ Î¿Î´Î·Î³ÏŒÏ‚ Î¼Ï€Î±Î¯Î½ÎµÎ¹ ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±
    socket.on('driver-status', (data) => {
        addLog(`ÎŸ Î¿Î´Î·Î³ÏŒÏ‚ ${data.name} ÎµÎ¯Î½Î±Î¹ ${data.status}`);
        updateDriverList(data);
    });

    function updateDriverList(data) {
        // ÎšÎ±Î¸Î±ÏÎ¯Î¶Î¿Ï…Î¼Îµ Ï„Î¿ "ÎšÎ±Î½Î­Î½Î±Ï‚ Î¿Î´Î·Î³ÏŒÏ‚" Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹
        if(driverListUI.innerText.includes("ÎšÎ±Î½Î­Î½Î±Ï‚")) driverListUI.innerHTML = "";
        
        // ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î®Î´Î· ÏƒÏ„Î· Î»Î¯ÏƒÏ„Î±
        const existing = document.getElementById(`driver-${data.name}`);
        if(!existing && data.status === 'online') {
            const li = document.createElement('li');
            li.id = `driver-${data.name}`;
            li.className = 'driver-item';
            li.innerHTML = `<span>ğŸ›µ ${data.name}</span> <span style="color: #4caf50; font-weight: bold;">â— LIVE</span>`;
            driverListUI.appendChild(li);
        }
    }

    function sendOrder() {
        const shop = document.getElementById('shopName').value.toLowerCase().trim();
        if(!shop) return alert("Î£Ï…Î½Î´Î­ÏƒÎ¿Ï… Ï€ÏÏÏ„Î±!");

        socket.emit('new-order', { 
            shop: shop,
            time: new Date().toLocaleTimeString()
        });
        addLog("Î— ÎµÎ¹Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ ÏƒÏ„Î¿Ï…Ï‚ Î¿Î´Î·Î³Î¿ÏÏ‚!");
    }

    // ÎŒÏ„Î±Î½ ÎºÎ¬Ï€Î¿Î¹Î¿Ï‚ Î¿Î´Î·Î³ÏŒÏ‚ Î±Ï€Î¿Î´Î­Ï‡ÎµÏ„Î±Î¹
    socket.on('order-confirmed', (data) => {
        alert(`âœ… Î— Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± Î­Î³Î¹Î½Îµ Î´ÎµÎºÏ„Î® Î±Ï€ÏŒ Ï„Î¿Î½ ${data.driverName}!`);
        addLog(`Î‘Ï€Î¿Î´Î¿Ï‡Î® Î±Ï€ÏŒ: ${data.driverName}`);
    });
</script>

</body>
</html>
