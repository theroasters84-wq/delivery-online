<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop Admin - 1234</title>
    <style>
        body { font-family: sans-serif; background: #f4f4f4; padding: 20px; text-align: center; }
        .container { max-width: 500px; margin: auto; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #ccc; font-size: 1em; }
        .btn-connect { width: 100%; padding: 12px; background: #333; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .driver-item { background: #fff; border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; }
        .btn-send { background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        #admin-panel { display: none; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div id="login-section">
        <h2>ğŸª Î•Î¯ÏƒÎ¿Î´Î¿Ï‚ ÎšÎ±Ï„Î±ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚</h2>
        <input type="text" id="shopName" placeholder="ÎŒÎ½Î¿Î¼Î± ÎœÎ±Î³Î±Î¶Î¹Î¿Ï">
        <input type="password" id="shopPass" placeholder="ÎšÏ‰Î´Î¹ÎºÏŒÏ‚ (Ï€.Ï‡. 1234)">
        <button class="btn-connect" onclick="connectShop()">Î•Î™Î£ÎŸÎ”ÎŸÎ£</button>
    </div>

    <div id="admin-panel">
        <h3 id="display-shop-name"></h3>
        <hr>
        <h4>ÎŸÎ´Î·Î³Î¿Î¯ Online:</h4>
        <ul id="driverList" style="list-style: none; padding: 0;">
            <li id="no-drivers" style="color: #888;">Î‘Î½Î±Î¼Î¿Î½Î® Î³Î¹Î± Î¿Î´Î·Î³Î¿ÏÏ‚...</li>
        </ul>
        <button onclick="location.reload()" style="background:none; border:none; color:red; cursor:pointer;">Î‘Ï€Î¿ÏƒÏÎ½Î´ÎµÏƒÎ·</button>
    </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();
    const driverListUI = document.getElementById('driverList');

    function connectShop() {
        const shop = document.getElementById('shopName').value.toLowerCase().trim();
        const pass = document.getElementById('shopPass').value;

        if (pass !== "1234") {
            alert("Î›Î¬Î¸Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚!");
            return;
        }

        if (!shop) return alert("Î’Î¬Î»Îµ ÏŒÎ½Î¿Î¼Î± Î¼Î±Î³Î±Î¶Î¹Î¿Ï!");

        socket.emit('shop-login', { shop: shop });
        
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('admin-panel').style.display = 'block';
        document.getElementById('display-shop-name').innerText = "ÎšÎ±Ï„Î¬ÏƒÏ„Î·Î¼Î±: " + shop.toUpperCase();
    }

    socket.on('driver-status', (data) => {
        if (data.status === 'online') {
            const noDrivers = document.getElementById('no-drivers');
            if (noDrivers) noDrivers.remove();
            
            if (document.getElementById(`driver-${data.name}`)) return;

            const li = document.createElement('li');
            li.id = `driver-${data.name}`;
            li.className = 'driver-item';
            li.innerHTML = `
                <strong>ğŸ›µ ${data.name}</strong>
                <button class="btn-send" onclick="sendToSpecific('${data.socketId}', '${data.name}')">Î‘Î ÎŸÎ£Î¤ÎŸÎ›Î—</button>
            `;
            driverListUI.appendChild(li);
        } else {
            const el = document.getElementById(`driver-${data.name}`);
            if (el) el.remove();
        }
    });

    function sendToSpecific(targetId, driverName) {
        const shop = document.getElementById('display-shop-name').innerText.replace("ÎšÎ±Ï„Î¬ÏƒÏ„Î·Î¼Î±: ", "").toLowerCase();
        socket.emit('send-private-order', { targetId, shop, driverName });
        alert("Î— Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ ÏƒÏ„Î¿Î½ " + driverName);
    }

    socket.on('order-confirmed', (data) => {
        alert("âœ… ÎŸ Î¿Î´Î·Î³ÏŒÏ‚ " + data.driverName + " Ï„Î·Î½ Î­Î»Î±Î²Îµ!");
    });
</script>
</body>
</html>
