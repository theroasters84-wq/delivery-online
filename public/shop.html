<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop Panel - The Roasters</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; background: #f0f2f5; padding: 20px; margin: 0; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { color: #1a1a1a; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        /* Î›Î¯ÏƒÏ„Î± ÎÏ„ÎµÎ»Î¹Î²ÎµÏÎ¬Î´Ï‰Î½ */
        .driver-box { 
            background: #fff; 
            padding: 20px; 
            margin: 15px 0; 
            border-radius: 12px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border: 2px solid #e0e0e0;
            transition: 0.3s;
        }
        .driver-box:hover { border-color: #e67e22; }
        .driver-name { font-size: 1.2em; font-weight: bold; color: #333; }
        
        /* ÎšÎ¿Ï…Î¼Ï€Î¯ ÎšÎ»Î®ÏƒÎ·Ï‚ */
        .btn-call { 
            background: #e67e22; 
            color: white; 
            border: none; 
            padding: 12px 25px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: bold; 
            font-size: 1em;
            text-transform: uppercase;
        }
        .btn-call:hover { background: #d35400; }
        .btn-call:active { transform: scale(0.98); }

        /* ÎŸÎ¸ÏŒÎ½Î· ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚ */
        #status-display { 
            margin-top: 30px; 
            padding: 25px; 
            border-radius: 12px; 
            font-size: 1.4em; 
            font-weight: bold;
            background: #f8f9fa; 
            color: #666;
            border: 3px dashed #ccc;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.5s ease;
        }

        /* ÎŒÏ„Î±Î½ Î±Ï€Î¿Î´Î­Ï‡ÎµÏ„Î±Î¹ Î¿ Î½Ï„ÎµÎ»Î¹Î²ÎµÏÎ¬Ï‚ */
        .status-accepted { 
            background: #27ae60 !important; 
            color: white !important; 
            border: 3px solid #1e8449 !important;
            animation: success-pulse 0.5s ease;
        }

        @keyframes success-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .no-drivers { color: #999; font-style: italic; padding: 20px; }
    </style>
</head>
<body>

    <div class="container">
        <h1>The Roasters - ÎšÎµÎ½Ï„ÏÎ¹ÎºÏŒ â˜•</h1>
        
        <div id="driver-list">
            <p class="no-drivers">Î‘Î½Î±Î¼Î¿Î½Î® Î³Î¹Î± ÏƒÏÎ½Î´ÎµÏƒÎ· Î½Ï„ÎµÎ»Î¹Î²ÎµÏÎ¬Î´Ï‰Î½...</p>
        </div>
        
        <div id="status-display">
            Î•Î¤ÎŸÎ™ÎœÎŸ Î“Î™Î‘ ÎšÎ›Î—Î£Î—
        </div>
    </div>

    <audio id="success-sound" src="https://actions.google.com/sounds/v1/notifications/positive_notification.ogg"></audio>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const statusDisplay = document.getElementById('status-display');
        const driverList = document.getElementById('driver-list');
        const successSound = document.getElementById('success-sound');

        // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î»Î¯ÏƒÏ„Î±Ï‚ Î½Ï„ÎµÎ»Î¹Î²ÎµÏÎ¬Î´Ï‰Î½
        socket.on('update-drivers', (drivers) => {
            if (Object.keys(drivers).length === 0) {
                driverList.innerHTML = '<p class="no-drivers">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Î¹ Î½Ï„ÎµÎ»Î¹Î²ÎµÏÎ¬Î´ÎµÏ‚.</p>';
                return;
            }

            driverList.innerHTML = "";
            for (let id in drivers) {
                driverList.innerHTML += `
                    <div class="driver-box">
                        <span class="driver-name">ğŸ‘¤ ${drivers[id]}</span>
                        <button class="btn-call" onclick="callDriver('${id}', '${drivers[id]}')">ğŸ”” ÎšÎ›Î—Î£Î—</button>
                    </div>`;
            }
        });

        // Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î± ÎšÎ»Î®ÏƒÎ·Ï‚
        function callDriver(id, name) {
            const time = new Date().toLocaleTimeString('el-GR', { hour: '2-digit', minute: '2-digit' });
            socket.emit('call-driver', { driverId: id, time: time });
            
            statusDisplay.innerText = "Î‘Î½Î±Î¼Î¿Î½Î® Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·Ï‚ Î±Ï€ÏŒ: " + name + "...";
            statusDisplay.classList.remove('status-accepted');
            statusDisplay.style.background = "#fff3cd";
            statusDisplay.style.color = "#856404";
            statusDisplay.style.borderColor = "#ffeeba";
        }

        // Î›Î®ÏˆÎ· Î‘Ï€Î¿Î´Î¿Ï‡Î®Ï‚ (Î•Î”Î© Î•Î™ÎÎ‘Î™ Î¤ÎŸ ÎšÎ¡Î™Î£Î™ÎœÎŸ Î£Î—ÎœÎ•Î™ÎŸ)
        socket.on('driver-accepted', (data) => {
            console.log("Î— Ï€Î±ÏÎ±Î³Î³ÎµÎ»Î¯Î± Î­Î³Î¹Î½Îµ Î±Ï€Î¿Î´ÎµÎºÏ„Î® Î±Ï€ÏŒ Ï„Î¿Î½:", data.driverName);
            
            // 1. Î‘Î»Î»Î±Î³Î® ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·Ï‚
            statusDisplay.innerText = "âœ… ÎŸ " + data.driverName + " Î‘Î ÎŸÎ”Î•Î§Î¤Î—ÎšÎ•!";
            statusDisplay.classList.add('status-accepted');
            
            // 2. Î‰Ï‡Î¿Ï‚ ÎµÎ¹Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ·Ï‚ ÏƒÏ„Î¿ PC Ï„Î¿Ï… Î¼Î±Î³Î±Î¶Î¹Î¿Ï
            successSound.play().catch(err => console.log("Audio play failed"));

            // 3. Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬ Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ 10 Î´ÎµÏ…Ï„ÎµÏÏŒÎ»ÎµÏ€Ï„Î±
            setTimeout(() => {
                statusDisplay.innerText = "Î•Î¤ÎŸÎ™ÎœÎŸ Î“Î™Î‘ ÎšÎ›Î—Î£Î—";
                statusDisplay.classList.remove('status-accepted');
                statusDisplay.style.background = "#f8f9fa";
                statusDisplay.style.color = "#666";
                statusDisplay.style.borderColor = "#ccc";
            }, 10000);
        });
    </script>
</body>
</html>
